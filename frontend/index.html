<!DOCTYPE html>
<html lang="en">

<header>
    <style>
        .name{
            padding: 2px;
            margin: 3px;
            cursor: pointer;
        }
    </style>
</header>

<body>
<h2>FLEX</h2>
<h3>All names:</h3>
<div id="all_names"></div>
</body>

<script>

    const HOST = 'http://localhost:8001/api'

    function request(url, callback) {
        let xhr = new XMLHttpRequest()
        xhr.onload = function () {
            if (xhr.status === 200) {
                callback(xhr.response)
            } else {
                console.error(`Error ${xhr.status}: ${xhr.statusText}`)
            }
        }
        xhr.open('GET', url, true)
        xhr.responseType = 'json'
        xhr.send(null)
    }

    function show_all_names(names) {
        document.getElementById('all_names').innerHTML = names.map(
            name => `<span class="name" onclick="onNameClick('${name}')">${name}</span>`
        ).reduce(
            (a, b) => a + b, ''
        )
    }

    function onNameClick(name) {
        request(`${HOST}/data/${name}`, data => console.log(data))
    }

    request(`${HOST}/names`, names => show_all_names(names))

</script>

</html>